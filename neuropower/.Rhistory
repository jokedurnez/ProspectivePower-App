lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[2],lwd=3)
lines(A$mids,F$density,col=cols[3],lwd=3)
lines(A$mids,G$density,col=cols[4],lwd=3)
lines(A$mids,H$density,col=cols[2],lwd=3)
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of 200 numbers in 10^5 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,C$density,col=cols[2],lwd=3)
lines(A$mids,B$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
NALnosmoothVALUESA
NALnosmoothVALUESA-NULnosmoothVALUES
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of 200 numbers in 10^5 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,C$density,col=cols[2],lwd=3)
lines(A$mids,B$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[2],lwd=3)
lines(A$mids,F$density,col=cols[3],lwd=3)
lines(A$mids,G$density,col=cols[4],lwd=3)
lines(A$mids,H$density,col=cols[2],lwd=3)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=cols[1:4],lty=c(1,2))
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,2))
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,2),lwd=3)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,2),lwd=3,bty="n")
legend(4.5,1,c("max(N(0,1))","max(N(0,1)) truncated","max(N(1,1))","max(N(1,1)) truncated"),lty=c(1,2,1,2),col=cols[1:4],lwd=3,bty="n")
results <- data.frame(NULnosmoothCOUNT,ALTnosmoothCOUNT,NALnosmoothCOUNTA,NALnosmoothCOUNTI,NULsmoothCOUNT,ALTsmoothCOUNT,NALsmoothCOUNTA,NALsmoothCOUNTI)
?lits
?list
values <- list(NULnosmoothVALUES,ALTnosmoothVALUES)
names(values)
values
head(values)
values <- list(NULnosmoothVALUES,ALTnosmoothVALUES,NALnosmoothVALUESA,NALnosmoothVALUESI,NULsmoothVALUES,ALTsmoothVALUES,NALsmoothVALUESA,NALsmoothVALUESI)
names(values) <- c("NULnosmoothVALUES","ALTnosmoothVALUES","NALnosmoothVALUESA","NALnosmoothVALUESI","NULsmoothVALUES","ALTsmoothVALUES","NALsmoothVALUESA","NALsmoothVALUESI")
values$NULnosmoothVALUES
write.list("~/Documents/Onderzoek/Studie_4_propow/test/testvalues.txt")
?lapply
library(R.utils)
saveObject(values,"~/Documents/Onderzoek/Studie_4_propow/test/testvalues.Rbin")
y <- loadObject <- "~/Documents/Onderzoek/Studie_4_propow/test/testvalues.Rbin"
y
y <- loadObject("~/Documents/Onderzoek/Studie_4_propow/test/testvalues.Rbin")
y
names(y)
colMeans(results)
saveObject(results,"~/Documents/Onderzoek/Studie_4_propow/test/testcounts.Rbin")
colMeans(results)
boxplot(results)
boxplot(results,pch=16,col=cols)
boxplot(results,pch=2,col=cols)
boxplot(results,pch=20,col=cols)
boxplot(results,pch=20,col=cols[1:4])
boxplot(results[,1:4],pch=20,col=cols[1:4])
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,2))
boxplot(results[,1:4],pch=20,col=cols[1:4])
names(results)
boxplot(results[,1:4],pch=20,col=cols[1:4],main="not smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
?axis
boxplot(results[,1:4],pch=20,col=cols[1:4],main="not smooth",axes=FALSE,labels=c("null","alternative","null in\n mixed","alternative in \n mixed"),at=1:4)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
boxplot(results[,1:4],pch=20,col=cols[1:4],main="not smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alternative","null in\n mixed","alternative in \n mixed"),at=1:4)
boxplot(results[,1:4],pch=20,col=cols[1:4],main="not smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alternative","null in\n mixed","alternative in \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alternative","null \n mixed","alternative \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
boxplot(results[,1:4],pch=20,col=cols[1:4],main="not smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alternative","null \n mixed","alternative \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
boxplot(results[,1:4],pch=20,col=cols[1:4],main="not smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,2))
boxplot(results[,1:4],pch=20,col=cols[1:4],main="not smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
boxplot(results[,5:8],pch=20,col=cols[1:4],main="smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,2))
boxplot(results[,1:4],pch=20,col=cols[1:4],main="not smooth",axes=FALSE,ylab="peaks per voxel")
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
boxplot(results[,5:8],pch=20,col=cols[1:4],main="smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
cols <- brewer.pal(8,"Set1")
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0))
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of 200 numbers in 10^5 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,B$density,col=cols[2],lwd=3)
lines(A$mids,C$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[1],lwd=3,lty=2)
lines(A$mids,F$density,col=cols[2],lwd=3,lty=2)
lines(A$mids,G$density,col=cols[3],lwd=3,lty=2)
lines(A$mids,H$density,col=cols[4],lwd=3,lty=2)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,2),lwd=3,bty="n")
cols <- brewer.pal(8,"Set1")
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,1))
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of 200 numbers in 10^5 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,B$density,col=cols[2],lwd=3)
lines(A$mids,C$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[1],lwd=3,lty=2)
lines(A$mids,F$density,col=cols[2],lwd=3,lty=2)
lines(A$mids,G$density,col=cols[3],lwd=3,lty=2)
lines(A$mids,H$density,col=cols[4],lwd=3,lty=2)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,2),lwd=3,bty="n")
histbreaks <- seq(from=-1,to=8,by=0.05)
A <- hist(NULnosmoothVALUES,plot=FALSE,breaks=histbreaks)
B <- hist(ALTnosmoothVALUES,plot=FALSE,breaks=histbreaks)
C <- hist(NALnosmoothVALUESA,plot=FALSE,breaks=histbreaks)
D <- hist(NALnosmoothVALUESI,plot=FALSE,breaks=histbreaks)
E <- hist(NULsmoothVALUES,plot=FALSE,breaks=histbreaks)
F <- hist(ALTsmoothVALUES,plot=FALSE,breaks=histbreaks)
G <- hist(NALsmoothVALUESA,plot=FALSE,breaks=histbreaks)
H <- hist(NALsmoothVALUESI,plot=FALSE,breaks=histbreaks)
cols <- brewer.pal(8,"Set1")
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,1))
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of 200 numbers in 10^5 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,B$density,col=cols[2],lwd=3)
lines(A$mids,C$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[1],lwd=3,lty=2)
lines(A$mids,F$density,col=cols[2],lwd=3,lty=2)
lines(A$mids,G$density,col=cols[3],lwd=3,lty=2)
lines(A$mids,H$density,col=cols[4],lwd=3,lty=2)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,2),lwd=3,bty="n")
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of 200 numbers in 10^5 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,B$density,col=cols[2],lwd=3)
lines(A$mids,C$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[1],lwd=3,lty=2)
lines(A$mids,F$density,col=cols[2],lwd=3,lty=2)
lines(A$mids,G$density,col=cols[3],lwd=3,lty=2)
lines(A$mids,H$density,col=cols[4],lwd=3,lty=2)
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,1))
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of 200 numbers in 10^5 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,B$density,col=cols[2],lwd=3)
lines(A$mids,C$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[1],lwd=3,lty=3)
lines(A$mids,F$density,col=cols[2],lwd=3,lty=3)
lines(A$mids,G$density,col=cols[3],lwd=3,lty=3)
lines(A$mids,H$density,col=cols[4],lwd=3,lty=3)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,3),lwd=3,bty="n")
rm(list=ls(all))
rm(list=ls())
values <- loadObject("~/Documents/Onderzoek/Studie_4_propow/test/testvalues.Rbin")
results <- loadObject("~/Documents/Onderzoek/Studie_4_propow/test/testcounts.Rbin")
fix(values)
values <- loadObject("~/Documents/Onderzoek/Studie_4_propow/test/testvalues.Rbin")
results <- loadObject("~/Documents/Onderzoek/Studie_4_propow/test/testcounts.Rbin")
library(AnalyzeFMRI)
library(lattice)
library(gplots)
library(RColorBrewer)
library(R.utils)
values <- loadObject("~/Documents/Onderzoek/Studie_4_propow/test/testvalues.Rbin")
results <- loadObject("~/Documents/Onderzoek/Studie_4_propow/test/testcounts.Rbin")
attach(values)
NULnosmoothVALUES
attach(results)
histbreaks <- seq(from=-1,to=8,by=0.05)
A <- hist(NULnosmoothVALUES,plot=FALSE,breaks=histbreaks)
B <- hist(ALTnosmoothVALUES,plot=FALSE,breaks=histbreaks)
C <- hist(NALnosmoothVALUESA,plot=FALSE,breaks=histbreaks)
D <- hist(NALnosmoothVALUESI,plot=FALSE,breaks=histbreaks)
E <- hist(NULsmoothVALUES,plot=FALSE,breaks=histbreaks)
F <- hist(ALTsmoothVALUES,plot=FALSE,breaks=histbreaks)
G <- hist(NALsmoothVALUESA,plot=FALSE,breaks=histbreaks)
H <- hist(NALsmoothVALUESI,plot=FALSE,breaks=histbreaks)
cols <- brewer.pal(8,"Set1")
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,1))
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of 200 numbers in 10^5 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,B$density,col=cols[2],lwd=3)
lines(A$mids,C$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[1],lwd=3,lty=3)
lines(A$mids,F$density,col=cols[2],lwd=3,lty=3)
lines(A$mids,G$density,col=cols[3],lwd=3,lty=3)
lines(A$mids,H$density,col=cols[4],lwd=3,lty=3)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,3),lwd=3,bty="n")
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,2))
boxplot(results[,1:4],pch=20,col=cols[1:4],main="not smooth",axes=FALSE,ylab="peaks per voxel")
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
boxplot(results[,5:8],pch=20,col=cols[1:4],main="smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
names(results)
colMeans(results)
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,2))
boxplot(results[,c(1,2,4,3)],pch=20,col=cols[1:4],main="not smooth",axes=FALSE,ylab="peaks per voxel")
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
boxplot(results[,c(5,6,8,7)],pch=20,col=cols[1:4],main="smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
i <- 1
null <- rnorm(4000,0,1)
alt <- rnorm(4000,1,1)
NULnosmooth <- array(null,dim=rep(20,3))
NULnosmoothpeaks <- cluster(NULnosmooth)
ALTnosmooth <- array(alt,dim=rep(20,3))
ALTnosmoothpeaks <- cluster(ALTnosmooth)
NULsmooth <- GaussSmoothArray(NULnosmooth,voxdim=c(1,1,1),ksize=7,mask=array(1,dim=rep(20,3)),sigma=(diag((2.5/sqrt(8*log(2))),3)))
NULsmoothpeaks <- cluster(NULsmooth)
ALTsmooth <- GaussSmoothArray(ALTnosmooth,voxdim=c(1,1,1),ksize=7,mask=array(1,dim=rep(20,3)),sigma=(diag((2.5/sqrt(8*log(2))),3)))
ALTsmoothpeaks <- cluster(ALTsmooth)
cluster <- function(zmap){
dimZ <- dim(zmap)
Zstar <- array(0,dim=dimZ+c(2,2,2))
Zstar[2:(dimZ[1]+1),2:(dimZ[2]+1),2:(dimZ[3]+1)] <- zmap
peaks <- xco <- yco <- zco <- c()
locmax <- array(NA,dim=dimZ+c(2,2,2))
for(m in 2:(dim(Zstar)[1]-1)){
cat("=")
for(n in 2:(dim(Zstar)[2]-1)){
for(o in 2:(dim(Zstar)[3]-1)){
surroundings <- c(Zstar[m-1,n+1,o],
Zstar[m,n+1,o],
Zstar[m+1,n+1,o],
Zstar[m-1,n,o],
Zstar[m+1,n,o],
Zstar[m-1,n-1,o],
Zstar[m,n-1,o],
Zstar[m+1,n-1,o],
Zstar[m,n+1,o-1],
Zstar[m-1,n,o-1],
Zstar[m+1,n,o-1],
Zstar[m,n-1,o-1],
Zstar[m,n+1,o+1],
Zstar[m-1,n,o+1],
Zstar[m+1,n,o+1],
Zstar[m,n-1,o+1])
locmax[m,n,o] <- ifelse(Zstar[m,n,o]>max(surroundings),Zstar[m,n,o],0)
if(Zstar[m,n,o]>max(surroundings)){
peaks <- c(peaks,Zstar[m,n,o])
xco <- c(xco,m)
yco <- c(yco,n)
zco <- c(zco,o)
}
results <- data.frame(peaks,xco,yco,zco)
}
}
}
locnew <- locmax[2:(dimZ[1]+1),2:(dimZ[1]+1),2:(dimZ[1]+1)]
res <- list(locnew)
res$results <- results
return(res)
}
null <- rnorm(4000,0,1)
alt <- rnorm(4000,1,1)
NULnosmooth <- array(null,dim=rep(20,3))
NULnosmoothpeaks <- cluster(NULnosmooth)
ALTnosmooth <- array(alt,dim=rep(20,3))
ALTnosmoothpeaks <- cluster(ALTnosmooth)
NULsmooth <- GaussSmoothArray(NULnosmooth,voxdim=c(1,1,1),ksize=7,mask=array(1,dim=rep(20,3)),sigma=(diag((2.5/sqrt(8*log(2))),3)))
NULsmoothpeaks <- cluster(NULsmooth)
ALTsmooth <- GaussSmoothArray(ALTnosmooth,voxdim=c(1,1,1),ksize=7,mask=array(1,dim=rep(20,3)),sigma=(diag((2.5/sqrt(8*log(2))),3)))
ALTsmoothpeaks <- cluster(ALTsmooth)
NALnosmooth <- NULnosmooth
NALnosmooth[7:13,7:13,7:13] <- NULnosmooth[7:13,7:13,7:13]+1
NALnosmoothpeaks <- cluster(NALnosmooth)
ACT <- array(0,dim=rep(20,3))
ACT[7:13,7:13,7:13] <- 1
help <- NALnosmoothpeaks[[1]][ACT==1]
helpA <- help[help!=0]
help <- NALnosmoothpeaks[[1]][ACT==0]
helpN <- help[help!=0]
levelplot(NALnosmooth[,,10])
levelplot(NALnosmoothpeaks[[1]])
levelplot(NALnosmoothpeaks[[1]][,,10])
levelplot(NALnosmooth[,,10])
levelplot(NALnosmoothpeaks[[1]][,,10])
levelplot(NALnosmooth[,,10])
NALsmoothpeaks[[1]]
ACT[7:13,7:13,7:13] <- 1
levelplot(ACT[,,10])
help <- NALnosmoothpeaks[[1]][ACT==1]
helpA <- help[help!=0]
helpA
help <- NALnosmoothpeaks[[1]][ACT==0]
helpN <- help[help!=0]
helpN
sum(ACT)
length(helpA)/sum(ACT)
length(helpN)/(4000-sum(ACT))
NALsmoothpeaks[[1]][ACT==1]
NALnosmoothpeaks[[1]][ACT==1]
NALnosmoothpeaks[[1]][
NALnosmoothpeaks[[1]][
]
]
NALnosmoothpeaks[[1]]
help[help!=0]
help <- NALnosmoothpeaks[[1]][ACT==1]
help
helpA <- help[help!=0]
helpA
histbreaks <- seq(from=-1,to=8,by=0.05)
A <- hist(NULnosmoothVALUES,plot=FALSE,breaks=histbreaks)
B <- hist(ALTnosmoothVALUES,plot=FALSE,breaks=histbreaks)
C <- hist(NALnosmoothVALUESA,plot=FALSE,breaks=histbreaks)
D <- hist(NALnosmoothVALUESI,plot=FALSE,breaks=histbreaks)
E <- hist(NULsmoothVALUES,plot=FALSE,breaks=histbreaks)
F <- hist(ALTsmoothVALUES,plot=FALSE,breaks=histbreaks)
G <- hist(NALsmoothVALUESA,plot=FALSE,breaks=histbreaks)
H <- hist(NALsmoothVALUESI,plot=FALSE,breaks=histbreaks)
cols <- brewer.pal(8,"Set1")
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,1))
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of 200 numbers in 10^5 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,B$density,col=cols[2],lwd=3)
lines(A$mids,C$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[1],lwd=3,lty=3)
lines(A$mids,F$density,col=cols[2],lwd=3,lty=3)
lines(A$mids,G$density,col=cols[3],lwd=3,lty=3)
lines(A$mids,H$density,col=cols[4],lwd=3,lty=3)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,3),lwd=3,bty="n")
cols <- brewer.pal(8,"Set1")
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,1))
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of max of GRF in 10^3 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,B$density,col=cols[2],lwd=3)
lines(A$mids,C$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[1],lwd=3,lty=3)
lines(A$mids,F$density,col=cols[2],lwd=3,lty=3)
lines(A$mids,G$density,col=cols[3],lwd=3,lty=3)
lines(A$mids,H$density,col=cols[4],lwd=3,lty=3)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,3),lwd=3,bty="n")
cols <- brewer.pal(8,"Set1")
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,1))
plot(A$mids,A$density,type="l",col=cols[1],lwd=3,main="Distribution of local maxima of GRF in 10^3 simulations",xlab="Height",ylab="Density",xlim=c(-1,5),ylim=c(0,3.2))
lines(A$mids,B$density,col=cols[2],lwd=3)
lines(A$mids,C$density,col=cols[3],lwd=3)
lines(A$mids,D$density,col=cols[4],lwd=3)
lines(A$mids,E$density,col=cols[1],lwd=3,lty=3)
lines(A$mids,F$density,col=cols[2],lwd=3,lty=3)
lines(A$mids,G$density,col=cols[3],lwd=3,lty=3)
lines(A$mids,H$density,col=cols[4],lwd=3,lty=3)
legend(2,3,c("null","alternative","null in mixed field","alternative in mixed field","not smooth","smooth"),col=c(cols[1:4],1,1),lty=c(1,1,1,1,1,3),lwd=3,bty="n")
par(mar=c(4.5,4.5,3,1),oma=c(0,0,0,0),mfrow=c(1,2))
boxplot(results[,c(1,2,4,3)],pch=20,col=cols[1:4],main="not smooth",axes=FALSE,ylab="peaks per voxel")
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
boxplot(results[,c(5,6,8,7)],pch=20,col=cols[1:4],main="smooth",axes=FALSE)
box();axis(1,lwd=0,lwd.ticks=1,cex.axis=0.8,labels=c("null","alt","null \n mixed","alt \n mixed"),at=1:4);axis(2,lwd=0,lwd.ticks=1,cex.axis=0.8)
NULsmoothpeaks[[1]][ACT==1]
help2 <- NULsmoothpeaks[[1]][ACT==1]
help3 <- help2[help2!=0]
help3
NULsmoothpeaks
NULsmoothpeaks[[1]]
levelplot(NULsmoothpeaks[[1]][,,10])
levelplot(NALsmoothpeaks[[1]][,,10])
help2 <- NULnosmoothpeaks[[1]][ACT==1]
help3 <- help2[help2!=0]
help3
helpA
which(NULnosmoothpeaks[[1]][ACT==1],indices=TRUE)
?which
which(NULnosmoothpeaks[[1]][ACT==1],arr.ind=TRUE)
which(,arr.ind=TRUE)
levelplot(NULnosmoothpeaks[[1]])
levelplot(NULnosmoothpeaks[[1]][,,10])
levelplot(NALnosmoothpeaks[[1]][,,10])
levelplot(NALnosmoothpeaks[[1]][,,11])
levelplot(NULnosmoothpeaks[[1]][,,11])
NULnosmoothpeaks[[1]][13,13,11]
NALnosmoothpeaks[[1]][13,13,11]
help3
helpA
help4 <- NULnosmoothpeaks[[1]][ACT==0]
help5 <- help2[help2!=0]
help5
helpN
help4 <- NULnosmoothpeaks[[1]][ACT==0]
help4
help5 <- help4[help4!=0]
help5
length(help5)
length(helpN)
help4 <- NULnosmoothpeaks[[1]][ACT==1]
help5 <- help4[help4!=0]
help5
help <- NALnosmoothpeaks[[1]][ACT==1]
helpA <- help[help!=0]
helpA
help2 <- NULnosmoothpeaks[[1]][ACT==0]
help3 <- help2[help2!=0]
help3
helpN
length(helpN)
length(help3)
lenp5
help4
help5
helpA
c(help3,help5)
help1 <- c(help3,help5)
sort(help1)-sort(NULnosmooth)
help1 <- c(help3,help5)
help1
length(help1)
length(NULnosmoothpeaks)
NULnosmoothpeaks[[2]]
dim(NULnosmoothpeaks[[2]])
length(NULnosmoothpeaks)
length(help1)
help5/sum(ACT)
length(help5)/sum(ACT)
length(help3)/(4000-sum(ACT))
length(help5)
length(help3)
sum(ACT)
4000-sum(ACT)
20^3
dim(ACT)
dim(ALTnosmooth)
length(c(ALTnosmooth))
library(shiny)
setwd("~/Documents/Onderzoek/Studie_4_propow/ProspectivePower-app")
runApp()
setwd("~/Documents/Onderzoek/Studie_4_propow/ProspectivePower-app/neuropower")
runApp()
library(shinyapps)
deployApp()
deployApp()
deployApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
deployApp()
deployApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
deployApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?text
runApp()
runApp()
runApp()
runApp()
deployApp()
deployApp()
deployApp()
deployApp()
runApp()
runApp()
deployApp()
